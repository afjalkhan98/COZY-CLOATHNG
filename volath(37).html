<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AFJAL FASHION — Premium Fashion Store</title>
  <meta name="description" content="Shop premium jackets, dresses, shoes & accessories. Free shipping over ₹999. Easy returns. Secure payments.">
  <meta property="og:title" content="AFJAL FASHION">
  <meta property="og:description" content="Style that Defines You">
  <meta property="og:image" content="https://images.unsplash.com/photo-1441986300917-64672809604d?q=80&w=800">
  <meta property="og:url" content="https://afjal-fashion.vercel.app">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>AF</text></svg>">
  <style>
    :root{
      --bg:#ffffff; --card:#fff; --text:#111; --muted:#6b6b6b; --accent:#b8860b; --glass:rgba(255,255,255,0.7);
      --radius:14px; --shadow:0 8px 30px rgba(17,17,17,0.08); --danger:#e74c3c; --success:#27ae60;
    }
    [data-theme='dark']{--bg:#0f0f10;--card:#121213;--text:#e9e9ea;--muted:#9a9a9a;--accent:#d4af37;--danger:#c0392b;--success:#2ecc71}
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:Poppins,system-ui,Segoe UI,Roboto;background:var(--bg);color:var(--text);-webkit-font-smoothing:antialiased;line-height:1.5}
    a{color:inherit;text-decoration:none}
    .nav{position:sticky;top:0;z-index:60;background:linear-gradient(180deg,rgba(255,255,255,0.92),rgba(255,255,255,0.75));backdrop-filter:blur(10px);display:flex;align-items:center;justify-content:space-between;padding:14px 20px;border-bottom:1px solid rgba(0,0,0,0.05);box-shadow:0 2px 10px rgba(0,0,0,0.05)}
    [data-theme='dark'] .nav{background:linear-gradient(180deg,rgba(10,10,10,0.92),rgba(10,10,10,0.75));border-bottom:1px solid rgba(255,255,255,0.04)}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:44px;height:44px;border-radius:12px;background:linear-gradient(135deg,var(--accent),#8b5a2b);display:grid;place-items:center;color:#fff;font-weight:700;font-size:18px;box-shadow:0 4px 12px rgba(184,134,11,0.3)}
    .brand h1{margin:0;font-size:17px;font-weight:600}
    .brand .tagline{font-size:12px;color:var(--muted);font-weight:500}
    .nav-links{display:flex;gap:24px;align-items:center;font-weight:500}
    .nav-links a{padding:8px 14px;border-radius:10px;transition:all .2s;position:relative}
    .nav-links a:hover{background:rgba(184,134,11,0.12);color:var(--accent)}
    .nav-links a::after{content:'';position:absolute;bottom:0;left:50%;width:0;height:2px;background:var(--accent);transition:width .3s,left .3s;transform:translateX(-50%)}
    .nav-links a.active::after{width:70%}
    .actions{display:flex;gap:10px;align-items:center}
    .btn{padding:9px 16px;border-radius:12px;border:0;cursor:pointer;font-weight:600;font-size:14px;transition:all .2s;display:inline-flex;align-items:center;gap:6px}
    .btn:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(0,0,0,0.1)}
    .btn-ghost{background:transparent;color:var(--text)}
    .btn-primary{background:var(--accent);color:#fff}
    .btn-success{background:#25D366;color:#fff}
    .btn-danger{background:var(--danger);color:#fff}
    .search{display:flex;align-items:center;background:rgba(0,0,0,0.06);padding:8px 12px;border-radius:12px;gap:8px;width:380px;transition:all .2s}
    [data-theme='dark'] .search{background:rgba(255,255,255,0.06)}
    .search input{border:0;background:transparent;outline:none;width:100%;font-size:14px;font-family:inherit}
    .search:focus-within{background:rgba(0,0,0,0.1)}
    .page{display:none}
    .page.active{display:block}
    .hero{display:grid;grid-template-columns:1fr 460px;gap:32px;padding:40px 20px;align-items:center;max-width:1400px;margin:0 auto}
    .hero-card{padding:32px;border-radius:20px;background:linear-gradient(135deg,var(--card),rgba(255,255,255,0.9));box-shadow:var(--shadow);transition:transform .6s cubic-bezier(.2,.9,.2,1)}
    .hero-card:hover{transform:translateY(-8px)}
    .hero h2{margin:0;font-size:38px;font-weight:700;line-height:1.2}
    .hero p{color:var(--muted);margin-top:10px;font-size:16px}
    .hero-cta{margin-top:20px;display:flex;gap:14px}
    .hero-media{height:460px;border-radius:20px;background:linear-gradient(120deg,#f8f7f2,#fff);display:flex;align-items:center;justify-content:center;box-shadow:var(--shadow);overflow:hidden;position:relative}
    .hero-media video{width:100%;height:100%;object-fit:cover}
    .toolbar{display:flex;gap:14px;align-items:center;padding:12px 20px;flex-wrap:wrap;background:var(--card);border-radius:16px;margin:0 20px 20px;box-shadow:0 2px 8px rgba(0,0,0,0.05)}
    .filters{display:flex;gap:10px;flex-wrap:wrap}
    .filter{padding:8px 16px;border-radius:999px;border:1px solid rgba(0,0,0,0.08);cursor:pointer;font-size:13px;font-weight:500;transition:all .2s}
    .filter.active{background:var(--accent);color:#fff;border-color:var(--accent)}
    [data-theme='dark'] .filter{border:1px solid rgba(255,255,255,0.08)}
    .container{display:grid;grid-template-columns:1fr 380px;gap:28px;padding:0 20px 80px;max-width:1400px;margin:0 auto}
    .products{display:grid;grid-template-columns:repeat(3,1fr);gap:22px;min-height:400px}
    .card{background:var(--card);border-radius:16px;padding:16px;box-shadow:0 10px 30px rgba(0,0,0,0.06);transition:all .3s;cursor:pointer;position:relative;overflow:hidden}
    .card:hover{transform:translateY(-10px);box-shadow:0 20px 40px rgba(0,0,0,0.12)}
    .card .img{height:240px;border-radius:12px;overflow:hidden;display:grid;place-items:center;position:relative}
    .card img{width:100%;height:100%;object-fit:cover;transition:transform .6s}
    .card:hover img{transform:scale(1.08)}
    .card .badge{position:absolute;top:12px;left:12px;background:var(--success);color:#fff;padding:4px 10px;border-radius:8px;font-size:11px;font-weight:600}
    .card .out-of-stock-badge{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:var(--danger);color:#fff;padding:8px 16px;border-radius:12px;font-size:14px;font-weight:600;z-index:2;pointer-events:none}
    .meta{display:flex;justify-content:space-between;align-items:center;margin-top:12px}
    .heart{cursor:pointer;padding:8px;border-radius:10px;transition:all .2s;display:grid;place-items:center}
    .heart.active{background:rgba(212,175,55,0.15);color:#b8860b}
    .side{position:sticky;top:100px;align-self:start}
    .cart{background:var(--card);padding:20px;border-radius:16px;box-shadow:var(--shadow)}
    .cart .item{display:flex;gap:12px;align-items:center;padding:12px 0;border-bottom:1px dashed rgba(0,0,0,0.06)}
    .cart .total{display:flex;justify-content:space-between;font-weight:700;padding-top:14px;font-size:16px}
    .checkout-flow{display:none;margin-top:20px;padding:16px;background:rgba(0,0,0,0.02);border-radius:12px}
    .step{padding:12px;border-radius:10px;margin-bottom:12px;background:linear-gradient(180deg,rgba(0,0,0,0.02),transparent)}
    .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.5);display:none;place-items:center;z-index:80}
    .modal{width:960px;max-width:94vw;background:var(--card);border-radius:18px;padding:20px;display:grid;grid-template-columns:1fr 400px;gap:20px;box-shadow:0 20px 60px rgba(0,0,0,0.2)}
    .fadeIn{animation:fadeIn .4s ease both}
    @keyframes fadeIn{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:none}}
    .collections-page,.about-page,.contact-page,.login-page,.profile-page{padding:60px 20px;max-width:1200px;margin:0 auto}
    .collections-page .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:24px}
    .collection-card{text-align:center;padding:20px;border-radius:16px;background:var(--card);box-shadow:var(--shadow);transition:all .3s}
    .collection-card:hover{transform:translateY(-8px)}
    .contact-page form{display:grid;gap:16px;max-width:600px;margin:0 auto}
    .contact-page input,.contact-page textarea{padding:14px;border:1px solid rgba(0,0,0,0.1);border-radius:12px;font-family:inherit;font-size:15px;transition:all .2s}
    .contact-page input:focus,.contact-page textarea:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 3px rgba(184,134,11,0.15)}
    .login-form,.register-form,.profile-form{display:inline-block;background:var(--card);padding:40px;border-radius:18px;box-shadow:var(--shadow);max-width:420px;width:100%;text-align:center}
    .user-info{display:flex;gap:10px;align-items:center;background:var(--glass);padding:8px 14px;border-radius:12px;font-weight:500}
    .user-info .avatar{width:32px;height:32px;border-radius:50%;background:var(--accent);display:grid;place-items:center;color:#fff;font-weight:600;font-size:13px}
    .admin-btn{position:fixed;bottom:24px;right:24px;background:var(--accent);color:#fff;width:60px;height:60px;border-radius:50%;display:grid;place-items:center;font-size:26px;box-shadow:0 6px 20px rgba(184,134,11,0.4);cursor:pointer;z-index:100;transition:all .2s}
    .admin-btn:hover{transform:scale(1.1)}
    .admin-panel{position:fixed;inset:0;background:rgba(0,0,0,0.6);display:none;place-items:center;z-index:110}
    .admin-box{background:var(--card);width:560px;max-height:90vh;overflow-y:auto;padding:24px;border-radius:18px;box-shadow:0 20px 60px rgba(0,0,0,0.2)}
    .toast{position:fixed;bottom:24px;left:50%;transform:translateX(-50%);background:var(--success);color:#fff;padding:12px 24px;border-radius:12px;font-weight:500;z-index:1000;opacity:0;animation:toastIn .4s forwards}
    @keyframes toastIn{to{opacity:1;transform:translateX(-50%) translateY(-12px)}}
    @media (max-width:1080px){.products{grid-template-columns:repeat(2,1fr)}.container{grid-template-columns:1fr 340px}.hero{grid-template-columns:1fr}}
    @media (max-width:820px){.hero-media{height:280px}.search{width:100%}.nav-links{display:none}.toolbar{flex-direction:column;align-items:stretch}.filters{justify-content:center}}
    @media (max-width:520px){.products{grid-template-columns:1fr}.nav{padding:12px}.hero{padding:32px 16px}.hero h2{font-size:28px}}
    .muted{color:var(--muted);font-size:13px}
    .pill{background:var(--card);padding:6px 10px;border-radius:999px;border:1px solid rgba(0,0,0,0.06);font-size:13px;cursor:pointer;transition:all .2s}
    .pill:hover{background:rgba(184,134,11,0.1)}
    [data-theme='dark'] .pill{border:1px solid rgba(255,255,255,0.06)}
    .loading{text-align:center;padding:60px;grid-column:1/-1;color:var(--muted);font-size:15px}
    .empty-state{text-align:center;padding:60px;grid-column:1/-1;color:var(--muted)}
    .empty-state svg{width:64px;height:64px;margin-bottom:16px;opacity:0.4}
  </style>
</head>
<body data-theme="light">
  <header class="nav">
    <div class="brand">
      <div class="logo">AF</div>
      <div>
        <h1>AFJAL FASHION</h1>
        <div class="tagline">Style that Defines You</div>
      </div>
    </div>
    <nav class="nav-links">
      <a href="#home" onclick="navigate('home')" class="active">Home</a>
      <a href="#collections" onclick="navigate('collections')">Collections</a>
      <a href="#about" onclick="navigate('about')">About</a>
      <a href="#contact" onclick="navigate('contact')">Contact</a>
    </nav>
    <div class="actions">
      <div class="search">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 21l-4.35-4.35"/><circle cx="11" cy="11" r="8"/></svg>
        <input id="search" placeholder="Search jackets, shoes, dresses...">
      </div>
      <div style="display:flex;gap:10px;align-items:center">
        <button class="btn btn-ghost" id="themeToggle">Dark Mode</button>
        <div class="user-info" id="userInfo" style="display:none">
          <div class="avatar" id="userAvatar">U</div>
          <span id="userName"></span>
          <button class="btn btn-ghost" onclick="showProfile()">Profile</button>
          <button class="btn btn-ghost" onclick="logout()">Logout</button>
        </div>
        <button class="btn btn-ghost" id="loginBtn" onclick="showLogin()">Login</button>
        <button class="btn btn-ghost" id="wishlistView">Wishlist <span id="wishCount">0</span></button>
        <button class="btn btn-primary" id="cartBtn">Cart (<span id="count">0</span>)</button>
        <button class="btn btn-success" id="whatsappOrder" onclick="sendWhatsAppOrder()" style="display:none">WhatsApp Order</button>
      </div>
    </div>
  </header>

  <div id="pageContainer">

    <!-- Home -->
    <div id="home" class="page active">
      <section class="hero">
        <div class="hero-card">
          <h2>New Season — Modern Classics</h2>
          <p class="muted">Curated fits, premium materials and effortless style — now with improved shopping experience.</p>
          <div class="hero-cta" style="margin-top:20px">
            <button class="btn btn-primary" onclick="scrollToProducts()">Shop Now</button>
            <a class="btn btn-ghost" href="#collections" onclick="navigate('collections')">View Collections</a>
          </div>
          <div style="margin-top:16px;display:flex;gap:12px;flex-wrap:wrap">
            <div class="pill">Free shipping over ₹999</div>
            <div class="pill">Easy Returns (7 days)</div>
            <div class="pill">Secure Payments</div>
            <div class="pill">24/7 Support</div>
          </div>
        </div>
        <div class="hero-media">
          <video autoplay muted loop playsinline poster="https://images.unsplash.com/photo-1441986300917-64672809604d?q=80&w=800">
            <source src="https://cdn.coverr.co/videos/coverr-fashion-model-walking-in-studio-1632/1080p" type="video/mp4">
          </video>
        </div>
      </section>

      <div class="toolbar">
        <div class="filters" id="filters">
          <div class="filter active" data-cat="All">All</div>
          <div class="filter" data-cat="Men">Men</div>
          <div class="filter" data-cat="Women">Women</div>
          <div class="filter" data-cat="Shoes">Shoes</div>
          <div class="filter" data-cat="Accessories">Accessories</div>
        </div>
        <div style="margin-left:auto;display:flex;gap:10px;align-items:center;flex-wrap:wrap">
          <select id="sort" class="btn btn-ghost" style="padding:8px 12px">
            <option value="default">Sort: Featured</option>
            <option value="price-asc">Price: Low to High</option>
            <option value="price-desc">Price: High to Low</option>
            <option value="newest">Newest First</option>
          </select>
          <div class="muted">Size:</div>
          <div id="sizeFilter" style="display:flex;gap:6px;flex-wrap:wrap"></div>
        </div>
      </div>

      <main class="container">
        <section>
          <div style="display:flex;justify-content:space-between;align-items:center;padding:8px 0">
            <h3 style="margin:0;font-size:20px;font-weight:600">Featured Products</h3>
            <div class="muted">Showing <span id="productCount">0</span> items</div>
          </div>
          <div class="products" id="products">
            <div class="loading">
              <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none" stroke-dasharray="31.42 31.42" transform="rotate(-90 12 12)"><animateTransform attributeName="transform" type="rotate" from="0 12 12" to="360 12 12" dur="1s" repeatCount="indefinite"/></circle></svg>
              <div>Loading premium collection...</div>
            </div>
          </div>
        </section>
        <aside class="side">
          <div class="cart" id="cartPanel">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
              <h4 style="margin:0;font-weight:600">Your Cart</h4>
              <div class="muted" id="cartStatus">Live</div>
            </div>
            <div id="cartItems"></div>
            <div class="total" style="margin-top:16px"><div>Subtotal</div><div id="subtotal">₹0</div></div>
            <div style="margin-top:16px;display:flex;gap:10px">
              <button class="btn btn-primary" id="startCheckout">Checkout</button>
              <button class="btn btn-ghost" id="clearCart">Clear All</button>
            </div>
            <div class="checkout-flow" id="checkoutFlow">
              <div class="step"><strong>1. Delivery Address</strong><input id="address" placeholder="Flat no, Building, Street, Area" style="width:100%;padding:12px;margin-top:8px;border-radius:12px;border:1px solid rgba(0,0,0,0.1);font-size:14px"></div>
              <div class="step"><strong>2. Payment Method</strong><select id="payment" style="width:100%;padding:12px;margin-top:8px;border-radius:12px;border:1px solid rgba(0,0,0,0.1);font-size:14px"><option>Cash on Delivery</option><option>Razorpay (Secure)</option></select></div>
              <div class="step"><strong>3. Review & Place Order</strong><button class="btn btn-success" id="placeOrder" style="margin-top:10px;width:100%">Place Order</button></div>
            </div>
          </div>
          <div style="height:20px"></div>
          <div class="card">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
              <div><div class="muted">Wishlist</div><div style="font-weight:600" id="wishTitle">Saved Items</div></div>
              <button class="btn btn-ghost" id="viewWishlist">Open</button>
            </div>
            <div id="wishList"></div>
          </div>
        </aside>
      </main>
    </div>

    <!-- Collections, About, Contact, Login, Profile -->
    <div id="collections" class="page"><div class="collections-page"><h2 style="text-align:center;margin-bottom:40px;font-size:32px;font-weight:700">Our Collections</h2><div class="grid" id="collectionsGrid"><div class="loading">Loading collections...</div></div></div></div>
    <div id="about" class="page"><div class="about-page"><h2 style="font-size:32px;font-weight:700;margin-bottom:24px">About AFJAL FASHION</h2><p style="font-size:16px;line-height:1.7">Founded in 2020, we bring premium fashion with a focus on quality, comfort, and sustainability. Free shipping over ₹999 across India.</p></div></div>
    <div id="contact" class="page"><div class="contact-page"><h2 style="text-align:center;font-size:32px;font-weight:700;margin-bottom:40px">Get in Touch</h2><form id="contactForm"><input placeholder="Your Name" required><input type="email" placeholder="Email Address" required><input type="tel" placeholder="Phone Number" required><textarea rows="5" placeholder="Your Message" required></textarea><button class="btn btn-primary">Send Message</button></form></div></div>
    <div id="login" class="page"><div class="login-page"><div class="login-form"><h2 style="margin-bottom:24px">Welcome Back</h2><input id="loginEmail" placeholder="Email" type="email" required><input id="loginPassword" placeholder="Password" type="password" required><button class="btn btn-primary" onclick="handleLogin()">Login</button><p style="margin-top:16px">New here? <a href="#" onclick="showRegister()">Create Account</a></p></div></div></div>
    <div id="profile" class="page"><div class="profile-page"><div class="profile-form"><h2 style="margin-bottom:24px">My Profile</h2><div style="display:flex;gap:16px;align-items:center;margin-bottom:20px"><div class="avatar" style="width:64px;height:64px;font-size:24px">U</div><div><div style="font-weight:600" id="profileName"></div><div class="muted" id="profileEmail"></div></div></div><button class="btn btn-primary" onclick="navigate('home')">Continue Shopping</button></div></div></div>
  </div>

  <!-- Modal -->
  <div class="modal-backdrop" id="modal">
    <div class="modal fadeIn">
      <div><div id="modalImgContainer" style="height:380px;border-radius:16px;overflow:hidden;background:#f8f7f2"><img id="mimg" src="" style="width:100%;height:100%;object-fit:cover"></div></div>
      <div>
        <h3 id="mTitle" style="font-size:22px;font-weight:600"></h3>
        <div style="display:flex;justify-content:space-between;align-items:center;margin-top:10px"><div id="mPrice" style="font-size:22px;font-weight:700"></div><div class="muted" id="mStock">In stock</div></div>
        <p class="muted" id="mDesc" style="margin-top:8px"></p>
        <div style="margin-top:16px">Size: <div id="mSizes" style="display:flex;gap:8px;margin-top:8px"></div></div>
        <div style="margin-top:20px;display:flex;gap:12px"><button class="btn btn-primary" id="mAdd">Add to Cart</button><button class="btn btn-ghost" id="mClose">Close</button></div>
      </div>
    </div>
  </div>

  <!-- Admin Panel -->
  <div class="admin-btn" id="adminBtn" style="display:none">Gear</div>
  <div class="admin-panel" id="adminPanel">
    <div class="admin-box">
      <h3 style="margin-bottom:20px">Admin Panel</h3>
      <button class="btn btn-ghost" style="position:absolute;top:16px;right:16px" onclick="closeAdmin()">Close</button>
      <div style="display:grid;gap:12px">
        <input id="adminName" placeholder="Product Name">
        <input id="adminPrice" type="number" placeholder="Price (₹)">
        <select id="adminCat"><option>Men</option><option>Women</option><option>Shoes</option><option>Accessories</option></select>
        <input id="adminImg" placeholder="Image URL">
        <input id="adminSizes" placeholder="Sizes (comma separated)">
        <input id="adminStock" type="number" placeholder="Stock Quantity" value="10">
        <button class="btn btn-primary" onclick="addProduct()">Add Product</button>
      </div>
      <div id="adminList" style="margin-top:24px;max-height:400px;overflow-y:auto"></div>
    </div>
  </div>

  <script>
    // Enhanced Products with Stock
    const sample = [
      {id:'p1',name:'Premium Leather Jacket',price:4999,cat:'Men',img:'https://images.unsplash.com/photo-1541099649105-f69ad21f3246?q=80&w=800',sizes:['S','M','L','XL'],stock:5},
      {id:'p2',name:'Slim Fit Denim Shirt',price:1299,cat:'Men',img:'https://images.unsplash.com/photo-1604176354204-9268737828e4?q=80&w=800',sizes:['M','L','XL'],stock:0},
      {id:'p3',name:'Pro Running Sneakers',price:3499,cat:'Shoes',img:'https://images.unsplash.com/photo-1542291026-7eec264c27ff?q=80&w=800',sizes:['7','8','9','10'],stock:3},
      {id:'p4',name:'Floral Summer Dress',price:2799,cat:'Women',img:'https://images.unsplash.com/photo-1595777457583-4e2dc3a2c5f2?q=80&w=800',sizes:['XS','S','M','L'],stock:8},
      {id:'p5',name:'Chelsea Boots',price:4599,cat:'Shoes',img:'https://images.unsplash.com/photo-1600585154340-be6161a56a0c?q=80&w=800',sizes:['7','8','9','10'],stock:2},
      {id:'p6',name:'Cashmere Scarf',price:899,cat:'Accessories',img:'https://images.unsplash.com/photo-1601925260368-ae2f83cf8bad?q=80&w=800',sizes:['One Size'],stock:15}
    ];

    let products = JSON.parse(localStorage.getItem('af_products')) || sample.map(p => ({...p}));
    let cart = JSON.parse(localStorage.getItem('af_cart')) || [];
    let wishlist = JSON.parse(localStorage.getItem('af_wishlist')) || [];
    let user = JSON.parse(localStorage.getItem('af_user')) || null;

    const formatINR = n => '₹' + n.toLocaleString('en-IN');
    const save = () => {
      localStorage.setItem('af_products', JSON.stringify(products));
      localStorage.setItem('af_cart', JSON.stringify(cart));
      localStorage.setItem('af_wishlist', JSON.stringify(wishlist));
      localStorage.setItem('af_user', JSON.stringify(user));
    };

    function toast(msg, type = 'success') {
      const t = document.createElement('div');
      t.className = 'toast';
      t.textContent = msg;
      t.style.background = type === 'error' ? 'var(--danger)' : 'var(--success)';
      document.body.appendChild(t);
      setTimeout(() => t.remove(), 3000);
    }

    function navigate(page) {
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      document.querySelectorAll('.nav-links a').forEach(a => a.classList.remove('active'));
      document.getElementById(page).classList.add('active');
      document.querySelector(`a[href="#${page}"]`).classList.add('active');
      window.location.hash = page;
      if (page === 'collections') renderCollections();
      if (page === 'profile' && user) renderProfile();
    }

    function showLogin() { navigate('login'); }
    function showRegister() { alert('Registration coming soon! Use: demo@afjal.com / 123'); }
    function showProfile() { if (user) { renderProfile(); navigate('profile'); } else showLogin(); }

    function handleLogin() {
      const email = document.getElementById('loginEmail').value.trim();
      const pass = document.getElementById('loginPassword').value;
      if (email === 'demo@afjal.com' && pass === '123') {
        user = { email, name: 'Demo User', phone: '+91 98765 43210' };
        save(); updateUserUI(); toast('Logged in successfully!'); navigate('home');
      } else {
        toast('Invalid credentials', 'error');
      }
    }

    function logout() {
      user = null; save(); updateUserUI(); toast('Logged out'); navigate('home');
    }

    function updateUserUI() {
      const info = document.getElementById('userInfo');
      const login = document.getElementById('loginBtn');
      const admin = document.getElementById('adminBtn');
      if (user) {
        info.style.display = 'flex';
        document.getElementById('userName').textContent = user.name.split(' ')[0];
        document.getElementById('userAvatar').textContent = user.name.charAt(0);
        login.style.display = 'none';
        document.getElementById('whatsappOrder').style.display = 'inline-block';
        admin.style.display = 'grid';
      } else {
        info.style.display = 'none';
        login.style.display = 'inline-block';
        document.getElementById('whatsappOrder').style.display = 'none';
        admin.style.display = 'none';
      }
    }

    function renderProfile() {
      document.getElementById('profileName').textContent = user.name;
      document.getElementById('profileEmail').textContent = user.email;
    }

    function getStock(id) {
      const p = products.find(x => x.id === id);
      const used = cart.filter(i => i.id === id).reduce((s, i) => s + i.qty, 0);
      return Math.max(0, (p.stock || 0) - used);
    }

    function renderProducts(list = products) {
      const el = document.getElementById('products');
      el.innerHTML = '<div class="loading"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none" stroke-dasharray="31.42 31.42" transform="rotate(-90 12 12)"><animateTransform attributeName="transform" type="rotate" from="0 12 12" to="360 12 12" dur="1s" repeatCount="indefinite"/></circle></svg><div>Loading premium collection...</div></div>';
      setTimeout(() => {
        el.innerHTML = list.length ? '' : '<div class="empty-state"><svg viewBox="0 0 24 24"><path d="M3 3h18v18H3z" fill="none" stroke="currentColor" stroke-width="2"/><path d="M3 9h18M9 9v12" stroke="currentColor" stroke-width="2"/></svg><div>No products found</div></div>';
        list.forEach(p => {
          const stock = getStock(p.id);
          const card = document.createElement('div');
          card.className = `card ${stock === 0 ? 'out-of-stock' : ''}`;
          card.innerHTML = `
            <div class="img"><img loading="lazy" src="${p.img}" alt="${p.name}">${stock === 0 ? '<div class="out-of-stock-badge">Out of Stock</div>' : ''}</div>
            <div style="display:flex;justify-content:space-between;align-items:center;margin-top:12px">
              <div><div style="font-weight:600;font-size:15px">${p.name}</div><div class="muted">${p.cat} • ${stock} left</div></div>
              <div class="heart ${wishlist.includes(p.id) ? 'active' : ''}" data-id="${p.id}">Heart</div>
            </div>
            <div class="meta">
              <div style="font-weight:700;font-size:16px">${formatINR(p.price)}</div>
              <div style="display:flex;gap:8px">
                <button class="btn btn-primary" data-action="view" data-id="${p.id}" ${stock===0?'disabled':''}>Quick View</button>
                <button class="btn btn-ghost" data-action="add" data-id="${p.id}" ${stock===0?'disabled':''}>Add</button>
              </div>
            </div>
          `;
          el.appendChild(card);
        });
        document.getElementById('productCount').textContent = list.length;
        attachProductHandlers();
      }, 400);
    }

    function attachProductHandlers() {
      document.querySelectorAll('[data-action="add"]').forEach(btn => btn.onclick = () => addToCart(btn.dataset.id));
      document.querySelectorAll('[data-action="view"]').forEach(btn => btn.onclick = () => openModal(btn.dataset.id));
      document.querySelectorAll('.heart').forEach(h => h.onclick = () => toggleWish(h.dataset.id, h));
    }

    function addToCart(id, size) {
      const p = products.find(x => x.id === id);
      const avail = getStock(id);
      if (avail <= 0) return toast('Out of stock!', 'error');
      const found = cart.find(i => i.id === id && i.size === (size || p.sizes[0]));
      if (found && found.qty >= avail) return toast('Not enough stock!', 'error');
      if (found) found.qty++; else cart.push({id, size: size || p.sizes[0], qty:1});
      save(); renderCart(); renderProducts(); toast('Added to cart!');
    }

    function renderCart() {
      const items = document.getElementById('cartItems');
      items.innerHTML = '';
      if (!cart.length) {
        items.innerHTML = '<div class="empty-state" style="padding:20px 0"><svg viewBox="0 0 24 24"><circle cx="9" cy="21" r="2"/><circle cx="20" cy="21" r="2"/><path d="M1 1h4l2.68 13.39a2 2 0 1 0 3.92.61h6.8a2 2 0 1 0 3.92-.61L23 3H6" fill="none" stroke="currentColor" stroke-width="2"/></svg><div>Your cart is empty</div></div>';
        document.getElementById('subtotal').textContent = '₹0';
        document.getElementById('count').textContent = '0';
        return;
      }
      let total = 0;
      cart.forEach(it => {
        const p = products.find(x => x.id === it.id);
        total += p.price * it.qty;
        const row = document.createElement('div'); row.className = 'item';
        row.innerHTML = `<img src="${p.img}" style="width:64px;height:64px;object-fit:cover;border-radius:10px">
          <div style="flex:1"><div style="font-weight:600">${p.name}</div><div class="muted">Size: ${it.size}</div></div>
          <div style="text-align:right"><div>${formatINR(p.price)}</div>
          <div style="margin-top:6px;display:flex;gap:4px;justify-content:flex-end">
            <button class="btn btn-ghost" onclick="changeQty('${it.id}',-1,'${it.size}')">-</button>
            <span style="padding:6px 10px;font-weight:600">${it.qty}</span>
            <button class="btn btn-ghost" onclick="changeQty('${it.id}',1,'${it.size}')">+</button>
          </div></div>`;
        items.appendChild(row);
      });
      document.getElementById('subtotal').textContent = formatINR(total);
      document.getElementById('count').textContent = cart.reduce((s,i)=>s+i.qty,0);
    }

    window.changeQty = (id, delta, size) => {
      const it = cart.find(i => i.id === id && i.size === size);
      if (!it) return;
      it.qty = Math.max(0, it.qty + delta);
      if (it.qty === 0) cart = cart.filter(x => !(x.id === id && x.size === size));
      save(); renderCart(); renderProducts();
    };

    function sendWhatsAppOrder() {
      if (!cart.length) return toast('Cart is empty', 'error');
      let msg = `*New Order from AFJAL FASHION*\n\n`;
      cart.forEach(it => {
        const p = products.find(x => x.id === it.id);
        msg += `• *${p.name}* (Size: ${it.size}, Qty: ${it.qty}) - ₹${p.price * it.qty}\n`;
      });
      const total = cart.reduce((s,i) => s + products.find(p=>p.id===i.id).price * i.qty, 0);
      msg += `\n*Total: ₹${total}*\n*Address:* ${document.getElementById('address').value || 'Please confirm'}\n*Customer:* ${user?.name || 'Guest'}`;
      const url = `https://wa.me/919876543210?text=${encodeURIComponent(msg)}`;
      window.open(url, '_blank');
      toast('Opening WhatsApp...');
    }

    // Init
    updateUserUI();
    renderProducts();
    renderCart();
    updateWishlistUI();
    window.addEventListener('hashchange', () => navigate(window.location.hash.slice(1) || 'home'));
    navigate(window.location.hash.slice(1) || 'home');
  </script>
</body>
</html>